{% extends 'base.html' %}

{% block title %}{{ post.titulo }} - Blog de Eletrônica Analógica{% endblock %}

{% block content %}
<article>
    <h2>{{ post.titulo }}</h2>
    <p style="color: #666; font-size: 0.9em;">
        Postado em {{ post.data_postagem|date:"d/m/Y H:i" }}
    </p>
    
    {% if post.categorias.all %}
        <div style="margin: 10px 0;">
            <strong>Categorias:</strong>
            {% for categoria in post.categorias.all %}
                <a href="{% url 'category_detail' categoria.id %}" 
                   style="display: inline-block; background-color: #007bff; color: white; padding: 5px 10px; 
                          margin: 5px 5px 5px 0; border-radius: 3px; text-decoration: none; font-size: 0.85em;">
                    {{ categoria.nome }}
                </a>
            {% endfor %}
        </div>
    {% endif %}
    
    <hr>
    
    <div style="line-height: 1.6;">
        {{ post.conteudo|safe }}
    </div>
    
    <hr>
    
    <div style="margin-top: 20px;">
        <a href="{% url 'post_list' %}" class="btn">Voltar</a>
        <a href="{% url 'post_edit' post.id %}" class="btn">Editar</a>
        <a href="{% url 'post_delete' post.id %}" class="btn btn-danger">Deletar</a>
    </div>
</article>

<!-- Seção de Comentários -->
<section style="margin-top: 40px; padding-top: 20px; border-top: 2px solid #ddd;">
    <h3>Comentários ({{ post.comments.count }})</h3>
    
    <div style="margin: 20px 0;">
        <a href="{% url 'comment_create' post.id %}" class="btn">Adicionar Comentário</a>
    </div>
    
    {% if post.comments.all %}
        <div style="margin-top: 20px;">
            {% for comment in post.comments.all %}
                <div style="background-color: #f9f9f9; padding: 15px; margin-bottom: 15px; border-left: 3px solid #007bff;">
                    <p style="margin: 0 0 10px 0;"><strong>{{ comment.autor.username }}</strong> 
                        <span style="color: #666; font-size: 0.85em;">- {{ comment.data_postagem|date:"d/m/Y H:i" }}</span>
                    </p>
                    <p style="margin: 0;">{{ comment.texto }}</p>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <p style="color: #666; font-style: italic;">Nenhum comentário ainda. Seja o primeiro a comentar!</p>
    {% endif %}
</section>
{% endblock %}
